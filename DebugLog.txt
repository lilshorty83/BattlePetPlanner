local function UpdateTabVisibility()
    -- Hide all tabs first
    for i, tab in ipairs(tabButtons) do
        tab:Hide()
    end
    -- Calculate centering
    local numTabs = math.min(TABS_PER_PAGE, #Route - tabPageStart + 1)
    local tabWidth = 110
    local tabSpacing = 1
    local totalTabWidth = numTabs * tabWidth + (numTabs-1) * tabSpacing
    local paneWidth = rightPane:GetWidth() or 400
    local startX = math.floor((paneWidth - totalTabWidth) / 2)
    -- Show only the current page of tabs, centered
    local visible = 0
    for i = tabPageStart, math.min(tabPageStart + TABS_PER_PAGE - 1, #Route) do
        visible = visible + 1
        local tab = tabButtons[i]
        if tab then
            tab:SetWidth(tabWidth)
            if visible == 1 then
                tab:ClearAllPoints()
                tab:SetPoint("TOPLEFT", rightPane, "TOPLEFT", startX, 0)
            else
                tab:ClearAllPoints()
                tab:SetPoint("LEFT", tabButtons[i-1], "RIGHT", tabSpacing, 0)
            end
            tab:Show()
        end
    end
    -- Enable/disable arrows
    if leftArrow then leftArrow:SetEnabled(tabPageStart > 1) end
    if rightArrow then rightArrow:SetEnabled(tabPageStart + TABS_PER_PAGE <= #Route) end
end

local function ScrollTabs(direction)
    local numTabs = #Route
    local maxPage = math.ceil(numTabs / TABS_PER_PAGE)
    local currentPage = math.ceil(tabPageStart / TABS_PER_PAGE)
    if direction == "left" then
        currentPage = math.max(1, currentPage - 1)
    elseif direction == "right" then
        currentPage = math.min(maxPage, currentPage + 1)
    end
    tabPageStart = (currentPage - 1) * TABS_PER_PAGE + 1
    UpdateTabVisibility()
end

-- Create tab buttons
-- (tabButtons population moved above)

-- Create left/right arrow buttons
leftArrow = CreateFrame("Button", nil, rightPane, "UIPanelButtonTemplate")
leftArrow:SetSize(32, 32)
leftArrow:SetText("<")
leftArrow:SetPoint("TOPLEFT", rightPane, "TOPLEFT", 3, 0)
leftArrow:SetScript("OnClick", function() ScrollTabs("left") end)

rightArrow = CreateFrame("Button", nil, rightPane, "UIPanelButtonTemplate")
rightArrow:SetSize(32, 32)
rightArrow:SetText(">")
rightArrow:SetPoint("TOPRIGHT", rightPane, "TOPRIGHT", -3, 0)
rightArrow:SetScript("OnClick", function() ScrollTabs("right") end)

UpdateTabVisibility()

-- ShowLandingPage() call removed; landing page will be shown via gui:SetScript("OnShow") and Home button only.
